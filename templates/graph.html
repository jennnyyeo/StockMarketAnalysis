<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Streak Display</title>
<style>
body {
    margin: 0;
    font-family: 'Segoe UI', Arial, sans-serif;
    background: #f5f6fa;
    display: flex;
}

/* Sidebar */
.sidebar {
    width: 240px;
    background: #1f2937;
    color: #fff;
    min-height: 100vh;
    padding: 1rem 0;
    position: fixed;
    left: 0;
    top: 0;
    transition: transform 0.3s ease;
    z-index: 1000;
}
.sidebar.hidden { transform: translateX(-100%); }
.sidebar h2 { text-align: center; margin: 0 0 1.5rem; font-size: 1.2rem; }
.sidebar ul { list-style: none; padding: 0; margin: 0; }
.sidebar ul li { padding: 0.8rem 1.5rem; cursor: pointer; font-size: 0.95rem; }
.sidebar ul li:hover { background: #374151; }
.sidebar ul li.active { background: #4f46e5; }
.sidebar ul li a { color: #fff; text-decoration: none; display: block; width: 100%; }

/* Main */
.main {
    flex: 1;
    display: flex;
    flex-direction: column;
    margin-left: 240px;
    transition: margin-left 0.3s ease;
}
.main.expanded { margin-left: 0; }

/* Topbar */
.topbar {
    background: #fff;
    padding: 0.8rem 1.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    position: relative;
}
.menu-btn { font-size: 1.5rem; cursor: pointer; margin-right: 1rem; }

/* Profile */
.profile { position: relative; cursor: pointer; }
.profile-circle {
    width: 36px; height: 36px; border-radius: 50%;
    background: #4f46e5; color: #fff;
    display: flex; align-items: center; justify-content: center;
    font-size: 1.2rem;
}
.dropdown {
    position: absolute; right: 0; top: 48px;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    overflow: hidden;
    display: none;
    min-width: 180px;
    z-index: 2000;
}
.dropdown.active { display: block; }
.dropdown li { list-style: none; padding: 0.8rem 1rem; font-size: 0.95rem; color: #374151; cursor: pointer; }
.dropdown li:hover { background: #f3f4f6; }

/* Content area */
.content { padding: 2rem; }
.card { 
    background: #fff; 
    border-radius: 12px; 
    padding: 1rem; 
    box-shadow: 0 2px 6px rgba(0,0,0,0.08); 
    margin-bottom: 1.5rem; 
}
.chart {
    width: 70%; height: 400px; border-radius: 12px;
    background: #fff; display: flex; align-items: center; justify-content: center;
    overflow: hidden; box-shadow: 0 2px 6px rgba(0,0,0,0.08); padding: 1rem;
}
.chart img { width: 100%; height: 100%; object-fit: contain; border-radius: 12px; }

@media (max-width: 768px) { .main { margin-left: 0; } }
</style>
</head>

<body>
<!-- Sidebar -->
<div class="sidebar" id="sidebar">
    <h2>SMA Company</h2>
    <ul>
        <li><a href="{{ url_for('smagraph') }}">SMA GRAPH</a></li>
        <li><a href="{{ url_for('home') }}">Trading Algorithm</a></li>
        <li class="active"><a href="{{ url_for('graph') }}">Streak Display</a></li>
        <li><a href="#">Portfolio</a></li>
        <li><a href="#">Settings</a></li>
    </ul>
</div>

<!-- Main content -->
<div class="main" id="main">
    <div class="topbar">
        <span class="menu-btn" id="menuBtn">â˜°</span>
        <h3>Streak Chart</h3>
        <div class="profile" id="profile">
            <div class="profile-circle">ðŸ‘¤</div>
            <ul class="dropdown" id="dropdown">
                <li>Account Management</li>
                <li>Settings</li>
                <li>Logout</li>
            </ul>
        </div>
    </div>

    <div class="content">
        <div class="card">
            <h4>Streak Chart</h4>
            <div style="text-align: center;">
            <label for="smaInput">Select Year:</label> 
            </div>
            <div style="text-align:center; margin-bottom:1rem;">
            <button class="year-btn" data-year="2020">2020</button>
            <button class="year-btn" data-year="2021">2021</button>
            <button class="year-btn" data-year="2022">2022</button>
            <button class="year-btn" data-year="2023">2023</button>
            <button class="year-btn" data-year="2024">2024</button>
            <button class="year-btn" data-year="2025">2025</button>
        </div>
            <img src="http://127.0.0.1:5000/streak.png?year=2020" alt="Streak Chart" id="streakChart">
        </div>
    </div>
</div>

<script>
const menuBtn = document.getElementById('menuBtn');
const sidebar = document.getElementById('sidebar');
const main = document.getElementById('main');
const profile = document.getElementById('profile');
const dropdown = document.getElementById('dropdown');

// Sidebar toggle
menuBtn.addEventListener('click', () => {
    sidebar.classList.toggle('hidden');
    main.classList.toggle('expanded');
});

// Profile dropdown toggle
profile.addEventListener('click', (e) => {
    e.stopPropagation();
    dropdown.classList.toggle('active');
});

// Close dropdown when clicking outside
document.addEventListener('click', (e) => {
    if (!profile.contains(e.target)) {
        dropdown.classList.remove('active');
    }
});
</script>

<script>
const yearButtons = document.querySelectorAll(".year-btn");
const streakChart = document.getElementById("streakChart");

yearButtons.forEach(btn => {
  btn.addEventListener("click", () => {
    const year = btn.getAttribute("data-year");
    let url = "";

    // Map year to the URL
    if (year === "2020") {
      url = "http://127.0.0.1:5000/streak.png?year=2020";
    } else if (year === "2021") {
      url = "http://127.0.0.1:5000/streak.png?year=2021";
    } else if (year === "2022") {
      url = "http://127.0.0.1:5000/streak.png?year=2022";
    } else if (year === "2023") {
      url = "http://127.0.0.1:5000/streak.png?year=2023";
    } else if (year === "2024") {
      url = "http://127.0.0.1:5000/streak.png?year=2024";
    } else if (year === "2025") {
      url = "http://127.0.0.1:5000/streak.png?year=2025";
    }

    // Add timestamp to bypass cache
    streakChart.src = url + "&_=" + new Date().getTime();
  });
});
</script>

</body>
</html>
